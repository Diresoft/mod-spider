// SASS Libraries
@use 'sass:color';
@use 'sass:math';
@use 'sass:map';

// Module Libraries
@use 'functions.scss' as *;

// Project Libraries

// Theme/Vars
@use 'vars.scss' as *;
@use '../../theme.scss' as *;


@mixin common 
{
	position:	absolute;
	z-index:	-1;

	left:	0;
	top:	0;
	right:	0;
	bottom:	0;
}

@mixin slab-height( $height: $height, $slope: $slope )
{
	$edge-run: slopeToDistance( $height, $slope );

	&::before {
		left:	$edge-run * -1;
		top:	$edge-run * -1;
		right:	$edge-run * -1;
		bottom:	$edge-run * -1;
		
	}
}

@mixin slab-transition( $duration: 250ms, $easing: ease-in-out, $properties: ( left, top, right, bottom, border-radius, transform ) ) {
	&::after {
		//transition: $transition;
		transition-duration: $duration;
		transition-property: $properties;
		transition-timing-function: $easing;
	}
}

@mixin slab( $height: $height, $corner-radius: $corner-radius, $slope: $slope, $base-curve: $base-curve, $lip-curve: $lip-curve, $colour: $surface-colour, $transition: 500ms ease-in-out ) {
	$lighting:		computeLighting( $height, $neumorphic-light, $colour );

	$surface-lit:		map.get( map.get( $lighting, "surface" ), "lit" );
	$surface-mid:		map.get( map.get( $lighting, "surface" ), "mid" );
	$surface-bg:		map.get( map.get( $lighting, "surface" ), "bg"  );
	$surface-drk:		map.get( map.get( $lighting, "surface" ), "drk" );
	$surface-sha:		map.get( map.get( $lighting, "surface" ), "sha" );
	
	$offset-pct-x:		map.get( $lighting, "offset-pct-x" );
	$offset-pct-y:		map.get( $lighting, "offset-pct-y" );
	$offset-x:			map.get( $lighting, "offset-x" );
	$offset-y:			map.get( $lighting, "offset-y" );

	$blend: cornerRadiusToBlendPercentage( $corner-radius );

	&::before {
		content: "";
		$radius-offset:	$height * 0.35;
		$r:				$corner-radius + $radius-offset;

		position:	absolute;
		z-index:	-1;


		border-radius:		$r;
		background-image:	linear-gradient(
			map.get( $neumorphic-light, "yaw" ) * -1,
			  $surface-drk   0% ( 50% - $blend )
			, $surface-mid
			, $surface-lit 100% ( 50% + $blend )
		);
		background-size: 100% 100%;
		background-position: 0% 0%;

		filter: blur( $base-curve );

		//@include slab-transition();
	}
	@include slab-height( $height );


	&::after {
		content: "";
		
		@include common();

		background-color:	$surface-mid;
		border-radius:		$corner-radius;

		filter:				blur( $lip-curve );
	}
	position:	relative;
	z-index:	0;
}